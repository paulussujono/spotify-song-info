(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{257:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(44),c=n(5),i=n.n(c),s=n(26),l=n.n(s),u=n(256),m=n.n(u),d="https://paulussujono.github.io/spotify-song-info/",f=["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"],p=function(e){var t,n=function(e){var t=Object(a.useState)(new m.a),n=i()(t,1)[0];Object(a.useEffect)((function(){n.setAccessToken(e)}),[e,n]);var r=Object(a.useState)(!1),o=i()(r,2),c=o[0],s=o[1],u=Object(a.useState)(!1),f=i()(u,2),p=f[0],b=f[1],h=Object(a.useState)(),g=i()(h,2),k=g[0],v=g[1],E=Object(a.useCallback)((function(){var e,t,a,r,o,c,i,u,m,f,p,h,g,k;return l.a.async((function(E){for(;;)switch(E.prev=E.next){case 0:return s(!0),b(!1),E.prev=2,E.next=5,l.a.awrap(n.getMyCurrentPlayingTrack());case 5:if(e=E.sent,t=null==e?void 0:e.item){E.next=11;break}v(void 0),E.next=21;break;case 11:return o=t.id,c=t.name,i=t.artists,u=t.album,m=null==(a=i[0])?void 0:a.name,f=null==(r=u.images.find((function(e){return 300===e.width})))?void 0:r.url,p={id:o,name:c,artist:m,albumArtUrl:f},E.next=17,l.a.awrap(n.getAudioAnalysisForTrack(p.id));case 17:h=E.sent,g=h.track,k={tempo:{value:g.tempo,confidence:g.tempo_confidence},timeSignature:{value:g.time_signature,confidence:g.time_signature_confidence},key:{value:g.key,confidence:g.key_confidence},mode:{value:g.mode,confidence:g.mode_confidence}},v({meta:p,analysis:k});case 21:b(!1),E.next=29;break;case 24:E.prev=24,E.t0=E.catch(2),E.t0 instanceof XMLHttpRequest&&401===E.t0.status&&window.location.replace(d),v(void 0),b(!0);case 29:return E.prev=29,s(!1),E.finish(29);case 32:case"end":return E.stop()}}),null,null,[[2,24,29,32]],Promise)}),[n]);return Object(a.useEffect)((function(){E()}),[E]),console.log({songInfo:k,isLoading:c,didError:p,refreshData:E}),{songInfo:k,isLoading:c,didError:p,refreshData:E}}(e.accessToken),c=n.songInfo,s=n.isLoading,u=(n.didError,n.refreshData);return r.a.createElement(r.a.Fragment,null,r.a.createElement(o.Skeleton,{h:"40",w:"40",isLoaded:!s},c&&r.a.createElement(o.Image,{key:c.meta.albumArtUrl,h:"40",w:"40",source:{uri:c.meta.albumArtUrl||"TODO placeholder"},alt:"Album artwork for "+c.meta.name})),r.a.createElement(o.Skeleton,{h:"34",w:"50",isLoaded:!s},c&&r.a.createElement(r.a.Fragment,null,r.a.createElement(o.Heading,{h:"8"},c.meta.name),r.a.createElement(o.Text,{h:"10",fontSize:"md",lineHeight:"20px"},c.meta.artist),r.a.createElement(o.Text,{h:"6",fontSize:"md",lineHeight:"20px"},(t=c.analysis.tempo.value,(Math.round(2*t)/2).toFixed(1)+" bpm")),r.a.createElement(o.Text,{h:"10",fontSize:"md",lineHeight:"20px"},f[function(e,t){var n=function(e,t){return t?e:(e+3)%12}(e,1===t);return{major:n,minor:function(e){return(e-3+12)%12}(n)}}(c.analysis.key.value,c.analysis.mode.value).major]+" Major"))),r.a.createElement(o.Button,{onPress:u},"Refresh"))},b=(Object(o.extendTheme)({config:{useSystemColorMode:!1,initialColorMode:"dark"}}),function(e){var t=e.accessToken;return r.a.createElement(o.NativeBaseProvider,null,r.a.createElement(o.Center,{_dark:{bg:"blueGray.900"},_light:{bg:"blueGray.50"},px:4,flex:1},r.a.createElement(o.VStack,{space:5,alignItems:"center"},r.a.createElement(p,{accessToken:t}))))}),h=function(){return Object(a.useEffect)((function(){window.location.replace("https://accounts.spotify.com/authorize?response_type=token&client_id="+encodeURIComponent("500ff9e9af7042d0b81606887981a1a5")+"&scope="+encodeURIComponent("user-read-currently-playing")+"&redirect_uri="+encodeURIComponent(d))}),[]),null};t.a=function(){var e=new URLSearchParams(window.location.hash.substr(1)).get("access_token");return e?r.a.createElement(b,{accessToken:e}):r.a.createElement(h,null)}},258:function(e,t,n){e.exports=n(602)}},[[258,1,2]]]);
//# sourceMappingURL=app.a1a13298.chunk.js.map